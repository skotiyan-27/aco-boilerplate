/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as i,jsxs as d,Fragment as F}from"@dropins/tools/preact-jsx-runtime.js";import{useState as f,useCallback as z,useEffect as B,useMemo as E,Fragment as A}from"@dropins/tools/preact-compat.js";import{classes as L,Slot as V,VComponent as Y}from"@dropins/tools/lib.js";import{IllustratedMessage as q,Button as G,Icon as J,SkeletonRow as K,Skeleton as O}from"@dropins/tools/components.js";import{W as Q}from"../chunks/WishlistItem.js";import{events as H}from"@dropins/tools/event-bus.js";import{s as $}from"../chunks/removeProductsFromWishlist.js";import{useText as R,Text as j}from"@dropins/tools/i18n.js";import{W as U}from"../chunks/WishlistAlert.js";import{S as X}from"../chunks/Heart.js";import"../chunks/Trash.js";import"../chunks/getProductBySku.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/HeartFilled.js";const Z=({className:l,children:t,ctaLinkURL:e,...m})=>{const r=R({emptyWishlist:"Wishlist.EmptyWishlist.heading",message:"Wishlist.EmptyWishlist.message",cta:"Wishlist.EmptyWishlist.cta"});return i("div",{...m,className:L(["wishlist-empty-wishlist",l]),children:i(q,{className:L(["wishlist-empty-wishlist__wrapper",l]),"data-testid":"wishlist-empty-wishlist",heading:r.emptyWishlist,icon:i(J,{className:"wishlist-empty-wishlist__icon",source:X}),message:i("p",{children:r.message}),action:e?i(G,{"data-testid":"wishlist-empty-wishlist-button",size:"medium",variant:"primary",type:"submit",href:e,children:r.cta},"routeHome"):void 0})})},b=()=>i(K,{children:`
      <svg
          width="100%"
          height="100%"
          viewBox="0 0 288 658"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          preserveAspectRatio="xMinYMin meet"
        >
        <rect x="6" y="24" width="282px" height="480" rx="8" fill="#E8E8E8" />
        <rect x="6" y="522" width="280" height="22" rx="4" fill="#E8E8E8" />
        <rect x="6" y="556" width="132" height="22" rx="4" fill="#E8E8E8" />
        <rect x="6" y="592" width="280" height="48" rx="24" fill="#D9D9D9" />
      </svg>
    `}),C=()=>d(O,{"data-testid":"wishlist-loader",children:[i(b,{}),i(b,{}),i(b,{})]}),gi=({routeEmptyWishlistCTA:l,routeToWishlist:t,moveProdToCart:e,routeProdDetailPage:m,getProductData:r,getRefinedProduct:_,slots:W,...I})=>{const[g,S]=f(null),[x,a]=f($.authenticated),[k,p]=f($.isLoading),y=n=>a(n),[w,c]=f(null),v=z(n=>{const{action:h,item:o}=n;c(i(U,{action:h,item:o,routeToWishlist:t}))},[t]);return B(()=>{const n=H.on("authenticated",y),h=H.on("wishlist/alert",s=>v(s)),o=H.on("wishlist/data",s=>{S(s),p(!1)},{eager:!0});return()=>{n==null||n.off(),o==null||o.off(),h==null||h.off()}},[v]),i(T,{...I,wishlistData:g,wishlistAlert:w,routeEmptyWishlistCTA:l,moveProdToCart:e,getProductData:r,getRefinedProduct:_,isLoggedIn:x,isLoading:k,routeProdDetailPage:m,slots:W})},T=({className:l,wishlistData:t,wishlistAlert:e,isLoggedIn:m,isLoading:r,moveProdToCart:_,getProductData:W,getRefinedProduct:I,routeEmptyWishlistCTA:g,onLoginClick:S,routeProdDetailPage:x,slots:a,...k})=>{const[p,y]=f(e),w=R({wishlistHeading:"Wishlist.Wishlist.heading",wishlistLoadingHeading:"Wishlist.Wishlist.loading"}),c=E(()=>{var s;return((s=t==null?void 0:t.items)==null?void 0:s.length)>0?t.items.map(u=>i(Q,{item:u,getProductData:W,getRefinedProduct:I,moveProdToCart:_,routeProdDetailPage:x,imageNode:a!=null&&a.image?({defaultImageProps:N})=>i(V,{name:"image",slot:a.image,context:{defaultImageProps:N,item:u}}):void 0},u.id)):null},[t,_,W,x]);B(()=>{if(e){y(e);const s=setTimeout(()=>{y(null)},5e3);return()=>clearTimeout(s)}},[e]);const v=E(()=>p?i(Y,{node:p,className:"wishlist-wishlist__alert"}):null,[p]),n=()=>d(F,{children:[i("div",{className:"wishlist-wishlist__heading","data-testid":"wishlist-heading-wrapper",children:i("h1",{className:"wishlist-wishlist__heading-text","data-testid":"loader-wishlist-heading",children:w.wishlistLoadingHeading})}),i(C,{})]}),h=()=>c?d(F,{children:[o,i("div",{className:"wishlist-wishlist__content",children:c})]}):i("div",{className:L(["wishlist-wishlist__content","wishlist-wishlist__content--empty"]),children:d("div",{children:[i(Z,{"data-testid":"empty-wishlist",ctaLinkURL:g==null?void 0:g()}),!m&&i(P,{onLoginClick:S})]})}),o=E(()=>{var s;return c?i("div",{className:"wishlist-wishlist__heading","data-testid":"wishlist-heading-wrapper",children:i("h1",{className:"wishlist-wishlist__heading-text","data-testid":"default-wishlist-heading",children:(s=w.wishlistHeading)==null?void 0:s.split(" {count}").map((u,N)=>{var M;return d(A,{children:[u,N===0&&i("span",{className:"wishlist-wishlist__heading-count","data-testid":"wishlist-heading-count",children:`${t==null?void 0:t.items_count} products`})]},((M=t==null?void 0:t.id)==null?void 0:M.toString())+N)})})}):null},[w,c,t]);return d("div",{...k,className:L(["wishlist-wishlist",l]),children:[v,r?n():h()]})},P=({onLoginClick:l})=>d("div",{className:"wishlist-login__sign-in",children:[i("a",{"data-testid":"log-in-link",className:"wishlist-login__link",href:"",rel:"noreferrer",onClick:l,role:"button",children:i(j,{id:"Wishlist.Login.logIn"})}),i(j,{id:"Wishlist.Login.sync"})]});export{gi as Wishlist,gi as default};
